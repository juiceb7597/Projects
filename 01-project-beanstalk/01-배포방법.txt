#ap-northeast-1 도쿄 리전 기준입니다.

배포방법


1.Django 설정

devsearch-project/에서 진행
desearch/setting.py
line 16. 허용 주소 설정
line 181-182. 이메일 설정
line 203-205. S3버킷 설정

projects/management/commands/createsu.py
line 8-9. superuser 설정

devsearch-project 내 모든 파일을 django.zip으로 압축




2.VPC 구성

terraformVPC/ 에서 terraform 사용




3.Beanstalk 배포

새 환경 생성
웹 서버 환경
애플리케이션 이름 입력
환경이름 입력
도메인 입력 (devsearch/setting.py내 ALLOWED_HOSTS에 설정한 값)
플랫폼 설정 Python,Python3.8
애플리케이션 코드 - 코드 업로드 - django.zip
추가 옵션 구성

사전 설정 - 고가용성
용량 - 인스턴스 최소2 최대4
로드 밸런스 - alb
보안 - YourKeyPair
데이터베이스 - 엔진 postgres, 사용자 이름, 암호 설정, 고가용성
네트워크 - vpc('jp-vpc'), 로드밸런서 서브넷 'public-1a-elb', 'public-1c-elb'
                         인스턴스 서브넷 'private-1a-instance', 'private-1c-instance'
                         데이터베이스 서브넷 'private-1a-database', 'private-1c-database'
환경 생성
환경 생성 후
구성 - 소프트웨어 - 편집
환경 속성 - 추가
RDS_DB_NAME = ebdb
RDS_HOSTNAME = RDS에 생성된 인스턴스의 endpoint
RDS_USER_NAME = 데이터베이스 생성 때 만든 사용자 이름
RDS_PASSWORD = 데이터베이스 생성 때 만든 암호
RDS_PORT = 5432




4.Route 53 (Optional)
도메인 등록 
등록된 도메인으로 호스팅 영역 생성
레코드 생성 - 단순 레코드 정의 - 레코드 이름 www - 레코드 영역 A -
엔트포인트 Beanstalk 별칭 - 도쿄 리전 - 환경 선택 -단순 레코드 정의 




5.Http to https redirection (Optional)
Certificatre manager - 인증서 요청 - 퍼블릭 인증서 요청
- 완전히 정규화된 도메인 이름 *.YourRoute53DomainName
- 요청 - 인증서 ID 클릭 - 도메인 - Route53에서 레코드 생성
- 레코드 생성 - 호스팅영역에서 CNAME 생성된 후 발급 완료
Beanstalk - 환경 - 구성 - 로드밸런서 - 편집 - 리스너 Port443 HTTPS 등록(올바른 SSL정책)
- 적용
Ec2 콘솔 - 로드밸런서 - 리스너 http:80 편집 - 기본 작업 - 리디렉션 - HTTPS:443 - 상태 코드 301- 저장






